{% extends "index.html" %} {% block head %}
<title>{{ title }}</title>
<link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}" />
<link rel="stylesheet" href="{{ url_for('static', filename='form.css') }}" />
<link rel="stylesheet" href="{{ url_for('static', filename='users.css') }}" />
{% endblock %} {% block body %}
<div class="container">
  <div class="drawer">
    <a class="navicon" href="#"><i class="icon ion-navicon"></i></a>

    <div class="menu">
      <a data-menu="dashboard" href="#" class="active">Home</a>
      <a data-menu="users" href="#">Add</a>
      <a data-menu="download" href="#">Download</a>
      <a data-dialog="logout" href="#">Logout</a>
    </div>

    <span class="credits">ledgers v1.1.0</span>
  </div>

  <div class="content">
    <div class="page active" data-page="dashboard">
      <div class="header">
        <div class="title">
          <h2>Dashboard</h2>
        </div>
      </div>

      <div class="user-list">
        {% for user in users %}
        <div class="user-card">
          {% set avatar_path = 'uploads/' ~ (user.avatar if user.avatar else 'default.png') %}
          <img
            src="{{ url_for('static', filename=avatar_path) }}" alt="Avatar"
          />
          <h3>{{ user.name }}</h3>
          <p>{{ user.email }}</p>
          <div class="actions">
            <a
              href="{{ url_for('edit_user', user_id=user.id) }}"
              class="edit-btn"
              >Edit</a
            >
            <form
              action="{{ url_for('delete_user', user_id=user.id) }}"
              method="POST"
              onsubmit="return confirm('Are you sure you want to delete this user?');"
            >
              <button type="submit" class="delete-btn">Delete</button>
            </form>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

    <div class="page noflex" data-page="users">
      <div class="header">
        <div class="title">
          <h2>Users</h2>
        </div>
      </div>
      <div class="grid">
        <div class="info-container">
          <div class="form-container">
            <h2>Add New User</h2>
            <form
              action="/add-user"
              method="POST"
              enctype="multipart/form-data"
            >
              <div class="form-group">
                <label for="name">Full Name</label>
                <input type="text" id="name" name="name" required />
              </div>

              <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" name="email" required />
              </div>

              <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required />
              </div>

              <div class="form-group">
                <label for="avatar">Upload Avatar</label>
                <input type="file" id="avatar" name="avatar" accept="image/*" />
              </div>

              <button type="submit">Add User</button>
            </form>
          </div>

          {% with messages = get_flashed_messages(with_categories=true) %} {% if
          messages %} {% for category, message in messages %}
          <div class="popup-alert popup-{{ category }}">
            {{ message }}
            <button
              class="popup-close"
              onclick="this.parentElement.style.display='none';"
            >
              &times;
            </button>
          </div>
          {% endfor %} {% endif %} {% endwith %}
        </div>
      </div>
    </div>

    <div class="page noflex" data-page="download">
      <div class="header">
        <div class="title">
          <h2>Download</h2>
        </div>
      </div>
      <div class="grid">
        <div class="card wide">
          <div class="head">
            <span class="icon">
              <i class="icon ion-code-working"></i>
            </span>
            <span class="stat"> Cheat Client </span>
            <div class="status"></div>
          </div>
          <div class="body">
            <h2>Latest Version: v$_VERSION</h2>
            <p>changelog here</p>
          </div>
          <div class="footer">
            <div class="user">
              <div class="user-icon"></div>
              <span class="username"> Administrator </span>
            </div>
            <a class="download" href="#"
              >Download <i class="icon ion-archive"></i
            ></a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="sidebar"></div>
  Â 
  <div class="dialog">
    <div class="dialog-block">
      <h2>Are you sure you want to logout?</h2>
      <div class="controls">
        <a href="{{ url_for('logout') }}" class="button">Logout</a>
        <a data-dialog-action="cancel" href="#" class="button">Cancel</a>
      </div>
    </div>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="{{ url_for('static', filename='main.js') }}"></script>
<script>
  window.onload = function () {
    const popups = document.querySelectorAll(".popup-alert");
    setTimeout(() => {
      popups.forEach((popup) => (popup.style.display = "none"));
    }, 4000);
  };
</script>
{% endblock %}
